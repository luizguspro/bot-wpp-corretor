
# No webhook, adicione suporte para enviar mÃºltiplas mÃ­dias:

if "tem fotos" in incoming_msg.lower() or "ver imagens" in incoming_msg.lower():
    # Detecta cÃ³digo do imÃ³vel
    import re
    pattern = r'\b(AP|CA)\d{3,4}\b'
    matches = re.findall(pattern, incoming_msg.upper())
    
    if matches:
        property_code = matches[0]
        image_data = image_service.get_property_images(property_code)
        
        if image_data['found'] and image_data['images']:
            # Envia texto primeiro
            msg.body(f"ğŸ“¸ Aqui estÃ£o as fotos do {property_code}:")
            
            # Envia cada imagem
            for img_url in image_data['images'][:3]:  # MÃ¡ximo 3 imagens
                msg.media(img_url)
            
            # Adiciona tour virtual se houver
            if image_data['tour_virtual']:
                resp.message(f"ğŸ¥ Tour Virtual 360Â°: {image_data['tour_virtual']}")
